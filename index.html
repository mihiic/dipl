<html lang="en">
<head>
    <link rel="stylesheet" href="style.css" type="text/css"/>

    <script id="frag-shader-3d" type="x-shader/x-fragment">
        precision mediump float;
        varying vec3 v_normal;
        uniform vec3 u_reverseLightDirection;

        uniform vec4 u_color;

        void main() {
            vec3 normal = normalize(v_normal);
            float light = max(dot(normal, u_reverseLightDirection), 0.1);
            gl_FragColor = u_color;
            gl_FragColor.rgb *= light;
        }
    </script>

    <script id="vert-shader-3d" type="x-shader/x-vertex">
        attribute vec4 a_position;
        attribute vec3 a_normal;
        attribute vec4 a_weights;

        uniform mat4 u_worldViewProjection;
        uniform mat4 u_worldInverseTranspose;
        uniform mat4 u_bone;

        varying vec3 v_normal;

        void main() {
            float counterWeight = 1.0 - a_weights[0];
            gl_Position = u_worldViewProjection * (
            u_bone * a_position * a_weights[0] +
            a_position * counterWeight
            );
            v_normal = mat3(u_worldInverseTranspose) * a_normal;
        }
    </script>

    <script src="vendor/oimo.js"></script>
    <script src="index.js" type="module"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <title>Mihael Medan - Diplomski</title>
</head>
<body>
<div class="sidebar">
    <div class="title">Procedural foliage generation and wind simulation</div>
    <div class="version">v1.12</div>
    <div class="toggler">
        <div id="generation"
             onclick="foliage.setGeneration()"
             class="toggle-item">Generation
        </div>
        <div id="simulation"
             onclick="foliage.setSimulation()"
             class="toggle-item">Simulation
        </div>
    </div>
    <div class="sidebar-content" id="generation-form" style="display: none">
        <div class="form-group">
            <label>Area width <span class="hint">(1 - 10)</span></label>
            <input type="number" value="2">
        </div>
        <div class="form-group">
            <label>Area depth <span class="hint">(1 - 10)</span></label>
            <input type="number" value="2">
        </div>

        <div class="form-group">
            <label>Density <span class="hint">(plants per unit of area)</span></label>
            <input type="number" value="5">
        </div>

        <div class="form-group">
            <label>Level of Detail <span class="hint">(4 - 32)</span></label>
            <input type="number" value="8">
        </div>

        <div class="form-group">
            <label>Plant type</label>
            <select>
                <option>Random</option>
                <option>Typha</option>
                <option>Leaf</option>
                <option>Grass</option>
            </select>
        </div>

        <div class="form-group">
            <label>Plant height <span class="hint">(0.5 - 3, leave empty for dynamic)</span></label>
            <input>
        </div>

        <div class="form-group">
            <label>Plant elasticity <span class="hint">(0 - 1)</span></label>
            <input type="number" value="0.5">
        </div>

        <div class="main-button">
            Generate
        </div>
    </div>
    <div class="sidebar-content" id="simulation-form">
        <div class="form-group">
            <label>Wind strength <span class="hint">(1 - 10)</span></label>
            <input id="windStrength" type="number" value="2">
        </div>
        <div class="form-group">
            <label>Wind direction<span class="hint">(0 - 360, in degress)</span></label>
            <input id="windDirection" type="number" value="2">
        </div>

        <div class="form-group">
            <label>Wind Type</label>
            <select id="windType">
                <option>Single</option>
                <option>Steady</option>
                <option>Sine</option>
                <option>On and Off</option>
            </select>
        </div>

<!--        <div class="form-group">-->
<!--            <label>Plant height <span class="hint">(0.5 - 3, leave empty for dynamic)</span></label>-->
<!--            <input type="number" id="plantHeight">-->
<!--        </div>-->

<!--        <div class="form-group">-->
<!--            <label>Plant elasticity <span class="hint">(0 - 1)</span></label>-->
<!--            <input type="number" value="0.5" id="elasticity">-->
<!--        </div>-->

        <div class="main-button" onclick="foliage.generate()">
            Simulate
        </div>
    </div>
</div>
<div class="canvas-wrapper">
    <div class="control-bar"></div>
    <canvas id="main-canvas"></canvas>
</div>
</body>
</html>
